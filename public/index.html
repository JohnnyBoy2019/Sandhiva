<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sandhiva - Cultural Clinical Translator</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>ğŸ¥ Sandhiva</h1>
            <p class="subtitle">Cultural Clinical Translator</p>
        </header>

        <!-- Mode Selection Menu -->
        <nav class="mode-menu">
            <button class="mode-btn active" data-mode="telemed">ğŸ“¹ Telemedicine</button>
            <button class="mode-btn" data-mode="triage">ğŸš‘ Triage</button>
            <button class="mode-btn" data-mode="followup">ğŸ“‹ Follow-up</button>
            <button class="mode-btn" data-mode="transcription">ğŸ“ Transcription</button>
            <button class="mode-btn" data-mode="translator">ğŸŒ Translator</button>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Video Panel -->
            <section class="video-panel">
                <div class="video-container">
                    <div class="video-wrapper">
                        <h3>Provider View</h3>
                        <video id="providerVideo" autoplay playsinline muted></video>
                        <canvas id="providerCanvas"></canvas>
                        <div id="providerPose" class="pose-label"></div>
                    </div>
                    <div class="video-wrapper">
                        <h3>Patient View</h3>
                        <video id="patientVideo" loop playsinline></video>
                        <canvas id="patientCanvas"></canvas>
                        <div id="patientPose" class="pose-label"></div>
                    </div>
                </div>
                
                <!-- Captions -->
                <div class="captions">
                    <div class="caption" id="hindiCaption">
                        <strong>HI:</strong> <span id="hindiText">...</span>
                    </div>
                    <div class="caption" id="englishCaption">
                        <strong>EN:</strong> <span id="englishText">...</span>
                    </div>
                </div>
            </section>

            <!-- Bidirectional Chat Panel -->
            <section class="chat-panel" id="chatPanel">
                <h3>ğŸ’¬ Conversation</h3>
                <div class="chat-messages" id="chatMessages"></div>
                <div class="chat-input-area">
                    <input type="text" id="chatInput" placeholder="Type a message..." />
                    <button id="sendMessageBtn">Send</button>
                </div>
            </section>

            <!-- Phrase Input Panel -->
            <section class="input-panel">
                <h3>Patient Expression</h3>
                <div class="language-selector">
                    <label><input type="radio" name="language" value="hindi" checked> Hindi (à¤¹à¤¿à¤¨à¥à¤¦à¥€)</label>
                    <label><input type="radio" name="language" value="spanish"> Spanish (EspaÃ±ol)</label>
                    <label><input type="radio" name="language" value="punjabi"> Punjabi (à¨ªà©°à¨œà¨¾à¨¬à©€)</label>
                    <label><input type="radio" name="language" value="urdu"> Urdu (Ø§Ø±Ø¯Ùˆ)</label>
                    <label><input type="radio" name="language" value="bengali"> Bengali (à¦¬à¦¾à¦‚à¦²à¦¾)</label>
                    <label><input type="radio" name="language" value="tamil"> Tamil (à®¤à®®à®¿à®´à¯)</label>
                    <label><input type="radio" name="language" value="telugu"> Telugu (à°¤à±†à°²à±à°—à±)</label>
                    <label><input type="radio" name="language" value="gujarati"> Gujarati (àª—à«àªœàª°àª¾àª¤à«€)</label>
                    <label><input type="radio" name="language" value="mandarin"> Mandarin (ä¸­æ–‡)</label>
                    <label><input type="radio" name="language" value="arabic"> Arabic (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)</label>
                </div>
                <input type="text" id="phraseInput" placeholder="Enter patient's phrase or expression..." />
                <button id="analyzeBtn">ğŸ” Analyze Phrase</button>
                <button id="literalTranslateBtn">ğŸ¤– Get Literal Translation (Ollama)</button>
            </section>

            <!-- Interpretation Event Panel -->
            <section class="interpretation-panel" id="interpretationPanel" style="display: none;">
                <h2>ğŸ“Š Interpretation Event</h2>
                
                <div class="match-info">
                    <div class="confidence-bar">
                        <label>Match Confidence:</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="confidenceBar"></div>
                        </div>
                        <span id="confidenceText">0%</span>
                    </div>
                </div>

                <div class="interpretation-grid">
                    <!-- Matched Phrase -->
                    <div class="interpretation-card">
                        <h3>ğŸ¯ Matched Phrase</h3>
                        <p id="matchedPhrase" class="phrase-text"></p>
                        <p id="literalMeaning" class="literal-text"></p>
                    </div>

                    <!-- Top Meanings -->
                    <div class="interpretation-card">
                        <h3>ğŸ’¡ Top Meanings</h3>
                        <ul id="meaningsList"></ul>
                    </div>

                    <!-- Medical Interpretation -->
                    <div class="interpretation-card">
                        <h3>ğŸ©º Medical Interpretation</h3>
                        <p id="medicalInterpretation"></p>
                    </div>

                    <!-- Urgency Level -->
                    <div class="interpretation-card urgency-card">
                        <h3>â±ï¸ Urgency Level</h3>
                        <div id="urgencyLevel" class="urgency-indicator"></div>
                    </div>

                    <!-- Questions to Ask -->
                    <div class="interpretation-card">
                        <h3>â“ Questions to Ask</h3>
                        <ul id="questionsList"></ul>
                    </div>

                    <!-- Red Flags -->
                    <div class="interpretation-card alert">
                        <h3>âš ï¸ Red Flags</h3>
                        <ul id="redFlagsList"></ul>
                    </div>

                    <!-- Body Part Highlight -->
                    <div class="interpretation-card">
                        <h3>ğŸ«€ Body Region</h3>
                        <div id="bodyPartHighlight" class="body-diagram"></div>
                    </div>
                </div>

                <!-- Literal Translation Result -->
                <div id="literalTranslation" class="literal-translation" style="display: none;">
                    <h3>ğŸ¤– Literal Translation (Ollama)</h3>
                    <p id="literalTranslationText"></p>
                </div>

                <!-- Visit-Safe Documentation Text -->
                <div id="documentationText" class="documentation-text" style="display: none;">
                    <h3>ğŸ“‹ Visit-Safe Documentation</h3>
                    <div class="doc-box">
                        <p id="docText"></p>
                        <button id="copyDocBtn">ğŸ“‹ Copy to Clipboard</button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Controls -->
        <footer class="controls">
            <button id="startWebcam">ğŸ“· Start Webcam</button>
            <button id="loadSampleVideo">ğŸ¬ Load Sample Patient Video</button>
            <button id="togglePose">ğŸ‘¤ Toggle Pose Detection</button>
            <button id="toggleAudio" class="audio-btn">
                <span class="audio-icon">ğŸ¤</span>
                <span class="audio-status">Unmuted</span>
            </button>
            <div class="mode-info" id="modeInfo">Mode: Telemedicine</div>
        </footer>
    </div>

    <!-- Load TensorFlow.js and PoseNet -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection@2.1.0"></script>
    
    <!-- Load phrasebank data -->
    <script src="/data/phrasebank.js"></script>
    
    <!-- Load main application -->
    <script src="/js/app.js"></script>
</body>
</html>
